set terminal pngcairo size 1024,768 enhanced font 'Verdana,10'
set output 'lv_all_graphique.png'

set style data histogram
set style histogram cluster gap 1
set style fill solid border -1
set boxwidth 0.75

set grid ytics
set title "Consommation des stations"
set xlabel "Station LV"
set ylabel "Quantité"

set key off
set xtics rotate by -45 scale 0 font ",10"

# Définir les couleurs conditionnelles
set style line 1 lc rgb 'red'   # Consommation > Capacité
set style line 2 lc rgb 'green' # Consommation <= Capacité

# Lecture des données avec ':' comme séparateur
set datafile separator ':'

# Traçage avec deux conditions distinctes
plot '../lv_all_minmax.csv' using ($3 > $2 ? $3 : 1/0):xtic(1) title "Dépassement" with boxes ls 1, \
     '' using ($3 <= $2 ? $3 : 1/0):xtic(1) title "Sous le seuil" with boxes ls 2
